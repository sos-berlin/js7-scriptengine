import java
SOSHibernateFactory = java.type("com.sos.commons.hibernate.SOSHibernateFactory")

class JS7Job(js7.Job):
   
    def processOrder(self, js7Step):
        sql = "select TEXT_VALUE from JOC_VARIABLES where NAME='version'"

        factory = None
        session = None
        try :
            factory = SOSHibernateFactory("src/test/resources/hibernate.cfg.xml")
            factory.build()

            session = factory.openStatelessSession()
            result = session.getSingleValueNativeQuery(sql)

            js7Step.getLogger().info(f"[{sql}]{result}")
        
        finally:
            factory and factory.close(session)
       